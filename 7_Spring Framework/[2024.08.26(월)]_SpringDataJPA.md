# Spring Data JPA

- spring Data JPA API URL : https://docs.spring.io/spring-data/jpa/docs/current/api/org/springframework/data/jpa/repository/package-summary.html

## SpringBootJpaBasicCrudFind 프로젝트

### SpringBootJpaBasicCrudFind 프로젝트 생성

![SpringBootJpaBasicCrudFind_프로젝트_생성_1](./img/20240826/SpringBootJpaBasicCrudFind_프로젝트_생성_1.png)

![SpringBootJpaBasicCrudFind_프로젝트_생성_2](./img/20240826/SpringBootJpaBasicCrudFind_프로젝트_생성_2.png)

### 프로젝트 설정

- Gradle에서는 build.gradle의 dependencies에 dependency를 추가한다.
- [프로젝트명] 우클릭 → Gradle → Refresh Gradle Project로 Gradle 업데이트한다.

### application.properties

```java
spring.application.name=SpringBootJpaBasicCrudFind
server.port=8000

spring.datasource.url=jdbc:mysql://localhost:3306/jpa_basic_crud_find
spring.datasource.username=root
spring.datasource.password=root
spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver

spring.jpa.show-sql=true
```

### MySQL

- jpa_basic_crud_find 스키마 생성
- sts에 lombok 적용 설정 : https://m.blog.naver.com/daka1122/222837239050

### SpringBootJpaBasicCrudFind 프로젝트 코드

### src/main/resources/static/index.html

```java
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h1>index.html</h1>
</body>
</html>
```

### src/main/resources/static/mypage.html

```java
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
</head>
<body>
	<h1>mypage.html</h1>
</body>
</html>
```

### src/main/java/com/mycom/myapp/PageController.java

```java
package com.mycom.myapp;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;

// spring boot + jpa
// html 여러 개 + ajax

@Controller
public class PageController {
	
	@GetMapping("/mypage")
	public String mypage() {
		System.out.println("/mypage");
		return "/mypage.html";
	}

}
```

### src/main/java/com/mycom/myapp

- controller, entity, repository, service 패키지 생성
- PageController를 controller 패키지로 이동

### default crud

### entity/Student.java

```java
package com.mycom.myapp.entity;

import jakarta.persistence.Entity;
import jakarta.persistence.GeneratedValue;
import jakarta.persistence.GenerationType;
import jakarta.persistence.Id;
import jakarta.persistence.Table;
import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.Getter;
import lombok.NoArgsConstructor;
import lombok.Setter;
import lombok.ToString;

@Entity
@Table(name = "student")
//@Getter
//@Setter
//@ToString
//@NoArgsConstructor
//@AllArgsConstructor
@Data // = @Getter + @Setter + @ToString + @EqualsAndHashCode + @RequiredArgsConstructor ( private final ... )
// 연관 관계를 가지는 필드에 대해서는 toString()에서 제외되도록, 그리고 @EqualsAndHashCode에 의해 만들어지는 코드가 불필요한 관계의 sql을 수행하는 경우 발생
public class Student {

	@Id
	@GeneratedValue(strategy = GenerationType.IDENTITY)
	private int id;
	
	private String name;
	
	private String email;
	
	private String phone;
	
}
```

### repository/StudentRepository.java

```java
package com.mycom.myapp.repository;

import org.springframework.data.jpa.repository.JpaRepository;

import com.mycom.myapp.entity.Student;

public interface StudentRepository extends JpaRepository<Student, Integer>{
	
	// default로 제공되는 crud 등 method <- 자동으로 생성
	
	// find() : query method <- 직접 명시해 줘야 한다.

}
```

### service

### StudentServiceCrud.java

```java
package com.mycom.myapp.service;

import java.util.List;
import java.util.Optional;

import com.mycom.myapp.entity.Student;

public interface StudentServiceCrud {
	
	List<Student> listStudent();  // 목록
	long countStudent();  // 전체 건 수
	Optional<Student> detailStudent(int id);  // 상세 (table에서 찾지 못하는 경우 대응)
	List<Student> listStudent(int pageNumber, int pageSize);
	
	Student insertStudent(Student student);  // 등록
	Student updateStudent(Student student);  // 수정
	void deleteStudent(int id);  // 삭제

}
```

### StudentServiceCrudImpl.java

```java
package com.mycom.myapp.service;

import java.util.List;
import java.util.Optional;

import org.springframework.data.domain.Page;
import org.springframework.data.domain.PageRequest;
import org.springframework.data.domain.Pageable;
import org.springframework.stereotype.Service;

import com.mycom.myapp.entity.Student;
import com.mycom.myapp.repository.StudentRepository;

import lombok.RequiredArgsConstructor;

@Service
@RequiredArgsConstructor
public class StudentServiceCrudImpl implements StudentServiceCrud {

	// lombok의 @RequiredArgsConstructor 를 이용
	private final StudentRepository studentRepository;
	
//	public StudentServiceCrudImpl(StudentRepository studentRepository) {
//		this.studentRepository = studentRepository;
//	}
	
	@Override
	public List<Student> listStudent() {
		return studentRepository.findAll();
	}

	@Override
	public long countStudent() {
		return studentRepository.count();
	}

	@Override
	public Optional<Student> detailStudent(int id) {
		return studentRepository.findById(id);
	}

	@Override
	public Student insertStudent(Student student) {
		return studentRepository.save(student);
	}

	@Override
	public Student updateStudent(Student student) {
		return studentRepository.save(student);
	}

	@Override
	public void deleteStudent(int id) {
		studentRepository.deleteById(id);
	}

	@Override
	public List<Student> listStudent(int pageNumber, int pageSize) {
		Pageable pageable = PageRequest.of(pageNumber, pageSize);
		Page<Student> page = studentRepository.findAll(pageable);
		return page.toList();
	}

}
```

### controller/StudentControlllerCrud.java

```java
package com.mycom.myapp.controller;

import java.util.List;
import java.util.Optional;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import com.mycom.myapp.entity.Student;
import com.mycom.myapp.service.StudentServiceCrud;

import lombok.RequiredArgsConstructor;

@Controller
@ResponseBody
@RequestMapping("/students")
@RequiredArgsConstructor
public class StudentControllerCrud {

	private final StudentServiceCrud studentServiceCrud;
	
	@GetMapping("/list")
	public List<Student> listStudent() {
		return studentServiceCrud.listStudent();
	}
	
	@GetMapping("/detail/{id}")
	public Optional<Student> detailStudent(@PathVariable("id") int id) {
		return studentServiceCrud.detailStudent(id);
	}
	
	@GetMapping("/count")
	public long countStudent() {
		return studentServiceCrud.countStudent();
	}
	
	@GetMapping("/page")
	public List<Student> listStudent(@RequestParam("pageNumber") int pageNumber, @RequestParam("pageSize") int pageSize) {
		return studentServiceCrud.listStudent(pageNumber, pageSize);
	}
	
	@PostMapping("/insert")
	public Student insertStudent(Student student) {  // www.urlencoded
		return studentServiceCrud.insertStudent(student);
	}
	
	@PostMapping("/update")
	public Student updateStudent(Student student) {  // www.urlencoded
		return studentServiceCrud.updateStudent(student);
	}
	
	@GetMapping("/delete/{id}")
	public void deleteStudent(@PathVariable("id") int id) {  // www.urlencoded
		studentServiceCrud.deleteStudent(id);
	}
	
}
```

### postman 결과가 비어있는 경우 해결방안 - lombok 오류

- postman 결과 : {}
- 해결 방법 : [프로젝트명] 우클릭 → [properties] → [Java Compiler] → [Annotation Processing] → Enable project specific settings 체크
    
    ![postman_결과가_비어있는_경우_해결방안](./img/20240826/postman_결과가_비어있는_경우_해결방안.png)
    

### 실행 결과

![default_crud_실행결과](./img/20240826/default_crud_실행결과.png)

Spring Data JPA API : https://docs.spring.io/spring-data/jpa/reference/jpa/query-methods.html

### find() - findByName

### repository/StudentRepository.java

```java
package com.mycom.myapp.repository;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;

import com.mycom.myapp.entity.Student;

public interface StudentRepository extends JpaRepository<Student, Integer>{
	
	// default로 제공되는 crud 등 method <- 자동으로 생성
	
	// find() : query method <- 직접 명시해 줘야 한다.
	
	List<Student> findByName(String name);

}
```

### service

### StudentServiceFind.java

```java
package com.mycom.myapp.service;

import java.util.List;

import com.mycom.myapp.entity.Student;

public interface StudentServiceFind {

	List<Student> findByName(String name);
	
}
```

### StudentServiceCrudImpl.java

```java
package com.mycom.myapp.service;

import java.util.List;

import org.springframework.stereotype.Service;

import com.mycom.myapp.entity.Student;
import com.mycom.myapp.repository.StudentRepository;

import lombok.RequiredArgsConstructor;

@Service
@RequiredArgsConstructor
public class StudentServiceFindImpl implements StudentServiceFind{
	
	private final StudentRepository studentRepository;

	@Override
	public List<Student> findByName(String name) {
		return studentRepository.findByName(name);
	}
	
}
```

### controller/StudentControlllerFind.java

```java
package com.mycom.myapp.controller;

import java.util.List;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import com.mycom.myapp.entity.Student;
import com.mycom.myapp.service.StudentServiceFind;

import lombok.RequiredArgsConstructor;

@Controller
@ResponseBody
@RequestMapping("/students")
@RequiredArgsConstructor
public class StudentControllerFind {

	private final StudentServiceFind studentServiceFind;
	
	@GetMapping("/find/name")
	public List<Student> findByName(@RequestParam("name") String name) {
		return studentServiceFind.findByName(name);
	}
	
}
```

### 실행 결과

![find()_findByName_실행결과](./img/20240826/find()_findByName_실행결과.png)

### find() - findByEmailAndPhone/findByEmailOrPhone

### repository/StudentRepository.java

```java
package com.mycom.myapp.repository;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;

import com.mycom.myapp.entity.Student;

public interface StudentRepository extends JpaRepository<Student, Integer>{
	
	// default로 제공되는 crud 등 method <- 자동으로 생성
	
	// find() : query method <- 직접 명시해 줘야 한다.
	
	List<Student> findByName(String name);
	List<Student> findByEmailAndPhone(String email, String phone);
	List<Student> findByEmailOrPhone(String email, String phone);
	
}
```

### service

### StudentServiceFind.java

```java
package com.mycom.myapp.service;

import java.util.List;

import com.mycom.myapp.entity.Student;

public interface StudentServiceFind {

	List<Student> findByName(String name);
	List<Student> findByEmailAndPhone(String email, String phone);
	List<Student> findByEmailOrPhone(String email, String phone);
}
```

### StudentServiceCrudImpl.java

```java
package com.mycom.myapp.service;

import java.util.List;

import org.springframework.stereotype.Service;

import com.mycom.myapp.entity.Student;
import com.mycom.myapp.repository.StudentRepository;

import lombok.RequiredArgsConstructor;

@Service
@RequiredArgsConstructor
public class StudentServiceFindImpl implements StudentServiceFind{
	
	private final StudentRepository studentRepository;

	@Override
	public List<Student> findByName(String name) {
		return studentRepository.findByName(name);
	}

	@Override
	public List<Student> findByEmailAndPhone(String email, String phone) {
		return studentRepository.findByEmailAndPhone(email, phone);
	}
	
	@Override
	public List<Student> findByEmailOrPhone(String email, String phone) {
		return studentRepository.findByEmailOrPhone(email, phone);
	}
	
}
```

### controller/StudentControlllerFind.java

```java
package com.mycom.myapp.controller;

import java.util.List;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import com.mycom.myapp.entity.Student;
import com.mycom.myapp.service.StudentServiceFind;

import lombok.RequiredArgsConstructor;

@Controller
@ResponseBody
@RequestMapping("/students")
@RequiredArgsConstructor
public class StudentControllerFind {

	private final StudentServiceFind studentServiceFind;
	
	@GetMapping("/find/name")
	public List<Student> findByName(@RequestParam("name") String name) {
		return studentServiceFind.findByName(name);
	}
	
	@GetMapping("/find/emailandphone")
	public List<Student> findByEmailAndPhone(@RequestParam("email") String email, @RequestParam("phone") String phone) {
		return studentServiceFind.findByEmailAndPhone(email, phone);
	}
	
	@GetMapping("/find/emailorphone")
	public List<Student> findByEmailOrPhone(@RequestParam("email") String email, @RequestParam("phone") String phone) {
		return studentServiceFind.findByEmailOrPhone(email, phone);
	}
	
}
```

### 실행 결과

![find()_findByEmailAndPhone_findByEmailOrPhone_실행결과](./img/20240826/find()_findByEmailAndPhone_findByEmailOrPhone_실행결과.png)

### find() - StartingWith/EndingWith/Containing/like

### repository/StudentRepository.java

```java
package com.mycom.myapp.repository;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;

import com.mycom.myapp.entity.Student;

public interface StudentRepository extends JpaRepository<Student, Integer>{
	
	// default로 제공되는 crud 등 method <- 자동으로 생성
	
	// find() : query method <- 직접 명시해 줘야 한다.
	
	List<Student> findByName(String name);
	List<Student> findByEmailAndPhone(String email, String phone);
	List<Student> findByEmailOrPhone(String email, String phone);
	
	// search
	List<Student> findByNameStartingWith(String name);
	List<Student> findByEmailEndingWith(String email);
	List<Student> findByPhoneContaining(String phone);
	List<Student> findByNameLike(String name);
}
```

### service

### StudentServiceFind.java

```java
package com.mycom.myapp.service;

import java.util.List;

import com.mycom.myapp.entity.Student;

public interface StudentServiceFind {

	List<Student> findByName(String name);
	List<Student> findByEmailAndPhone(String email, String phone);
	List<Student> findByEmailOrPhone(String email, String phone);
	
	List<Student> findByNameStartingWith(String name);
	List<Student> findByEmailEndingWith(String email);
	List<Student> findByPhoneContaining(String phone);
	List<Student> findByNameLike(String name);
}
```

### StudentServiceCrudImpl.java

```java
package com.mycom.myapp.service;

import java.util.List;

import org.springframework.stereotype.Service;

import com.mycom.myapp.entity.Student;
import com.mycom.myapp.repository.StudentRepository;

import lombok.RequiredArgsConstructor;

@Service
@RequiredArgsConstructor
public class StudentServiceFindImpl implements StudentServiceFind{
	
	private final StudentRepository studentRepository;

	@Override
	public List<Student> findByName(String name) {
		return studentRepository.findByName(name);
	}

	@Override
	public List<Student> findByEmailAndPhone(String email, String phone) {
		return studentRepository.findByEmailAndPhone(email, phone);
	}
	
	@Override
	public List<Student> findByEmailOrPhone(String email, String phone) {
		return studentRepository.findByEmailOrPhone(email, phone);
	}

	@Override
	public List<Student> findByNameStartingWith(String name) {
		return studentRepository.findByNameStartingWith(name);
	}

	@Override
	public List<Student> findByEmailEndingWith(String email) {
		return studentRepository.findByEmailEndingWith(email);
	}

	@Override
	public List<Student> findByPhoneContaining(String phone) {
		return studentRepository.findByPhoneContaining(phone);
	}

	@Override
	public List<Student> findByNameLike(String name) {
//		return studentRepository.findByNameLike("%" + name);  // ending with
//		return studentRepository.findByNameLike(name + "%");  // starting with
		return studentRepository.findByNameLike("%" + name + "%");  // containing
	}
	
}
```

### controller/StudentControlllerFind.java

```java
package com.mycom.myapp.controller;

import java.util.List;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import com.mycom.myapp.entity.Student;
import com.mycom.myapp.service.StudentServiceFind;

import lombok.RequiredArgsConstructor;

@Controller
@ResponseBody
@RequestMapping("/students")
@RequiredArgsConstructor
public class StudentControllerFind {

	private final StudentServiceFind studentServiceFind;
	
	@GetMapping("/find/name")
	public List<Student> findByName(@RequestParam("name") String name) {
		return studentServiceFind.findByName(name);
	}
	
	@GetMapping("/find/emailandphone")
	public List<Student> findByEmailAndPhone(@RequestParam("email") String email, @RequestParam("phone") String phone) {
		return studentServiceFind.findByEmailAndPhone(email, phone);
	}
	
	@GetMapping("/find/emailorphone")
	public List<Student> findByEmailOrPhone(@RequestParam("email") String email, @RequestParam("phone") String phone) {
		return studentServiceFind.findByEmailOrPhone(email, phone);
	}
	
	@GetMapping("/find/namestartingwith")
	public List<Student> findByNameStartingWith(@RequestParam("name") String name) {
		return studentServiceFind.findByNameStartingWith(name);
	}
	
	@GetMapping("/find/emailendingwith")
	public List<Student> findByEmailEndingWith(@RequestParam("email") String email) {
		return studentServiceFind.findByEmailEndingWith(email);
	}
	
	@GetMapping("/find/phonecontaining")
	public List<Student> findByPhoneContaining(@RequestParam("phone") String phone) {
		return studentServiceFind.findByPhoneContaining(phone);
	}
	
	@GetMapping("/find/namelike")
	public List<Student> findByNameLike(@RequestParam("name") String name) {
		return studentServiceFind.findByNameLike(name);
	}
	
}
```

### 실행 결과

![find()_StartingWith_EndingWith_Containing_like_실행결과](./img/20240826/find()_StartingWith_EndingWith_Containing_like_실행결과.png)

### find() - findAllByOrderByNameDesc

### repository/StudentRepository.java

```java
package com.mycom.myapp.repository;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;

import com.mycom.myapp.entity.Student;

public interface StudentRepository extends JpaRepository<Student, Integer>{
	
	// default로 제공되는 crud 등 method <- 자동으로 생성
	
	// find() : query method <- 직접 명시해 줘야 한다.
	
	List<Student> findByName(String name);
	List<Student> findByEmailAndPhone(String email, String phone);
	List<Student> findByEmailOrPhone(String email, String phone);
	
	// search
	List<Student> findByNameStartingWith(String name);
	List<Student> findByEmailEndingWith(String email);
	List<Student> findByPhoneContaining(String phone);
	List<Student> findByNameLike(String name);
	
	// order by
	List<Student> findAllByOrderByNameDesc();
	
}
```

### service

### StudentServiceFind.java

```java
package com.mycom.myapp.service;

import java.util.List;

import com.mycom.myapp.entity.Student;

public interface StudentServiceFind {

	List<Student> findByName(String name);
	List<Student> findByEmailAndPhone(String email, String phone);
	List<Student> findByEmailOrPhone(String email, String phone);
	
	List<Student> findByNameStartingWith(String name);
	List<Student> findByEmailEndingWith(String email);
	List<Student> findByPhoneContaining(String phone);
	List<Student> findByNameLike(String name);
	
	List<Student> findAllByOrderByNameDesc();
	
}
```

### StudentServiceCrudImpl.java

```java
package com.mycom.myapp.service;

import java.util.List;

import org.springframework.stereotype.Service;

import com.mycom.myapp.entity.Student;
import com.mycom.myapp.repository.StudentRepository;

import lombok.RequiredArgsConstructor;

@Service
@RequiredArgsConstructor
public class StudentServiceFindImpl implements StudentServiceFind{
	
	private final StudentRepository studentRepository;

	@Override
	public List<Student> findByName(String name) {
		return studentRepository.findByName(name);
	}

	@Override
	public List<Student> findByEmailAndPhone(String email, String phone) {
		return studentRepository.findByEmailAndPhone(email, phone);
	}
	
	@Override
	public List<Student> findByEmailOrPhone(String email, String phone) {
		return studentRepository.findByEmailOrPhone(email, phone);
	}

	@Override
	public List<Student> findByNameStartingWith(String name) {
		return studentRepository.findByNameStartingWith(name);
	}

	@Override
	public List<Student> findByEmailEndingWith(String email) {
		return studentRepository.findByEmailEndingWith(email);
	}

	@Override
	public List<Student> findByPhoneContaining(String phone) {
		return studentRepository.findByPhoneContaining(phone);
	}

	@Override
	public List<Student> findByNameLike(String name) {
//		return studentRepository.findByNameLike("%" + name);  // ending with
//		return studentRepository.findByNameLike(name + "%");  // starting with
		return studentRepository.findByNameLike("%" + name + "%");  // containing
	}

	@Override
	public List<Student> findAllByOrderByNameDesc() {
		return studentRepository.findAllByOrderByNameDesc();
	}
	
}
```

### controller/StudentControlllerFind.java

```java
package com.mycom.myapp.controller;

import java.util.List;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import com.mycom.myapp.entity.Student;
import com.mycom.myapp.service.StudentServiceFind;

import lombok.RequiredArgsConstructor;

@Controller
@ResponseBody
@RequestMapping("/students")
@RequiredArgsConstructor
public class StudentControllerFind {

	private final StudentServiceFind studentServiceFind;
	
	@GetMapping("/find/name")
	public List<Student> findByName(@RequestParam("name") String name) {
		return studentServiceFind.findByName(name);
	}
	
	@GetMapping("/find/emailandphone")
	public List<Student> findByEmailAndPhone(@RequestParam("email") String email, @RequestParam("phone") String phone) {
		return studentServiceFind.findByEmailAndPhone(email, phone);
	}
	
	@GetMapping("/find/emailorphone")
	public List<Student> findByEmailOrPhone(@RequestParam("email") String email, @RequestParam("phone") String phone) {
		return studentServiceFind.findByEmailOrPhone(email, phone);
	}
	
	@GetMapping("/find/namestartingwith")
	public List<Student> findByNameStartingWith(@RequestParam("name") String name) {
		return studentServiceFind.findByNameStartingWith(name);
	}
	
	@GetMapping("/find/emailendingwith")
	public List<Student> findByEmailEndingWith(@RequestParam("email") String email) {
		return studentServiceFind.findByEmailEndingWith(email);
	}
	
	@GetMapping("/find/phonecontaining")
	public List<Student> findByPhoneContaining(@RequestParam("phone") String phone) {
		return studentServiceFind.findByPhoneContaining(phone);
	}
	
	@GetMapping("/find/namelike")
	public List<Student> findByNameLike(@RequestParam("name") String name) {
		return studentServiceFind.findByNameLike(name);
	}
	
	@GetMapping("/find/orderbynamedesc")
	public List<Student> findAllByOrderByNameDesc() {  // findAll ~ 과 findBy ~ 동일한 결과
		return studentServiceFind.findAllByOrderByNameDesc();
	}
	
}
```

### 실행 결과

![find()_findAllByOrderByNameDesc_실행결과](./img/20240826/find()_findAllByOrderByNameDesc_실행결과.png)

### find() - findByIdBetween

### repository/StudentRepository.java

```java
package com.mycom.myapp.repository;

import java.util.List;

import org.springframework.data.jpa.repository.JpaRepository;

import com.mycom.myapp.entity.Student;

public interface StudentRepository extends JpaRepository<Student, Integer>{
	
	// default로 제공되는 crud 등 method <- 자동으로 생성
	
	// find() : query method <- 직접 명시해 줘야 한다.
	
	List<Student> findByName(String name);
	List<Student> findByEmailAndPhone(String email, String phone);
	List<Student> findByEmailOrPhone(String email, String phone);
	
	// search
	List<Student> findByNameStartingWith(String name);
	List<Student> findByEmailEndingWith(String email);
	List<Student> findByPhoneContaining(String phone);
	List<Student> findByNameLike(String name);
	
	// order by
	List<Student> findAllByOrderByNameDesc();
	
	// between
	List<Student> findByIdBetween(int from, int to);
}
```

### service

### StudentServiceFind.java

```java
package com.mycom.myapp.service;

import java.util.List;

import com.mycom.myapp.entity.Student;

public interface StudentServiceFind {

	List<Student> findByName(String name);
	List<Student> findByEmailAndPhone(String email, String phone);
	List<Student> findByEmailOrPhone(String email, String phone);
	
	List<Student> findByNameStartingWith(String name);
	List<Student> findByEmailEndingWith(String email);
	List<Student> findByPhoneContaining(String phone);
	List<Student> findByNameLike(String name);
	
	List<Student> findAllByOrderByNameDesc();
	List<Student> findByIdBetween(int from, int to);
	
}
```

### StudentServiceCrudImpl.java

```java
package com.mycom.myapp.service;

import java.util.List;

import org.springframework.stereotype.Service;

import com.mycom.myapp.entity.Student;
import com.mycom.myapp.repository.StudentRepository;

import lombok.RequiredArgsConstructor;

@Service
@RequiredArgsConstructor
public class StudentServiceFindImpl implements StudentServiceFind{
	
	private final StudentRepository studentRepository;

	@Override
	public List<Student> findByName(String name) {
		return studentRepository.findByName(name);
	}

	@Override
	public List<Student> findByEmailAndPhone(String email, String phone) {
		return studentRepository.findByEmailAndPhone(email, phone);
	}
	
	@Override
	public List<Student> findByEmailOrPhone(String email, String phone) {
		return studentRepository.findByEmailOrPhone(email, phone);
	}

	@Override
	public List<Student> findByNameStartingWith(String name) {
		return studentRepository.findByNameStartingWith(name);
	}

	@Override
	public List<Student> findByEmailEndingWith(String email) {
		return studentRepository.findByEmailEndingWith(email);
	}

	@Override
	public List<Student> findByPhoneContaining(String phone) {
		return studentRepository.findByPhoneContaining(phone);
	}

	@Override
	public List<Student> findByNameLike(String name) {
//		return studentRepository.findByNameLike("%" + name);  // ending with
//		return studentRepository.findByNameLike(name + "%");  // starting with
		return studentRepository.findByNameLike("%" + name + "%");  // containing
	}

	@Override
	public List<Student> findAllByOrderByNameDesc() {
		return studentRepository.findAllByOrderByNameDesc();
	}

	@Override
	public List<Student> findByIdBetween(int from, int to) {
		return studentRepository.findByIdBetween(from, to);
	}
	
}
```

### controller/StudentControlllerFind.java

```java
package com.mycom.myapp.controller;

import java.util.List;

import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.ResponseBody;

import com.mycom.myapp.entity.Student;
import com.mycom.myapp.service.StudentServiceFind;

import lombok.RequiredArgsConstructor;

@Controller
@ResponseBody
@RequestMapping("/students")
@RequiredArgsConstructor
public class StudentControllerFind {

	private final StudentServiceFind studentServiceFind;
	
	@GetMapping("/find/name")
	public List<Student> findByName(@RequestParam("name") String name) {
		return studentServiceFind.findByName(name);
	}
	
	@GetMapping("/find/emailandphone")
	public List<Student> findByEmailAndPhone(@RequestParam("email") String email, @RequestParam("phone") String phone) {
		return studentServiceFind.findByEmailAndPhone(email, phone);
	}
	
	@GetMapping("/find/emailorphone")
	public List<Student> findByEmailOrPhone(@RequestParam("email") String email, @RequestParam("phone") String phone) {
		return studentServiceFind.findByEmailOrPhone(email, phone);
	}
	
	@GetMapping("/find/namestartingwith")
	public List<Student> findByNameStartingWith(@RequestParam("name") String name) {
		return studentServiceFind.findByNameStartingWith(name);
	}
	
	@GetMapping("/find/emailendingwith")
	public List<Student> findByEmailEndingWith(@RequestParam("email") String email) {
		return studentServiceFind.findByEmailEndingWith(email);
	}
	
	@GetMapping("/find/phonecontaining")
	public List<Student> findByPhoneContaining(@RequestParam("phone") String phone) {
		return studentServiceFind.findByPhoneContaining(phone);
	}
	
	@GetMapping("/find/namelike")
	public List<Student> findByNameLike(@RequestParam("name") String name) {
		return studentServiceFind.findByNameLike(name);
	}
	
	@GetMapping("/find/orderbynamedesc")
	public List<Student> findAllByOrderByNameDesc() {  // findAll ~ 과 findBy ~ 동일한 결과
		return studentServiceFind.findAllByOrderByNameDesc();
	}
	
	@GetMapping("/find/idbetween")
	public List<Student> findByIdBetween(@RequestParam("from") int from, @RequestParam("to") int to) {  // findAll ~ 과 findBy ~ 동일한 결과
		return studentServiceFind.findByIdBetween(from, to);
	}
	
}
```

### 실행 결과

![find()_findByIdBetween_실행결과](./img/20240826/find()_findByIdBetween_실행결과.png)